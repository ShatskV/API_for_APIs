# API для APIs

API для сбора данных с трех API: 

1. Сервис погоды (API KEY)
2. Google книги (без аутентификации)
3. Dropbox (OAuth 2.0)

API сделан с ипользованием библиотеки flask-restful

## Описание каждого сервиса

1. Получает погоду указанного города, по умолчанию - "Москва"
2. Ищет книги, выдает 3 результата, по умолчанию - "Ложная слепота" 
3. Показывает список файлов заданного расширения в указанной папке, по умолчанию - все файлы и корень папки. Реализована авторизация по коду и можно заменать refresh token на валидный. Также можно отозвать токены.
---
## Описание API 

### URI: http://127.0.0.1:5000/api

#### GET запрос
Собирает данные от сервисов

##### Параметры: 
- weather - выключает сбор данных с сервиса погода, значение по умолчанию - "true". 
- book_find - выключает сбор данных с сервиса поиска книг, значение по умолчанию - "true".
- dropbox_files - выключает сбор данных с Дропбокс, значение по умолчанию - "true".
Допустимые значения для этих параметров - "y", "yes", "t", "true", "on", "1", "n", "no", "f", "false", "off", "0"
- book - название книги
- city - название города
- mask, path - расширение файлов  и путь для поиска файлов в Дропбокс
- timeout_w, timeout_b, timeout_d - таймауты для сервисов, по умолчанию - прописаны в файле setting.py

Формат ответа: 
{"weather": {"status_code": 200, "data": {...} }, 
 "book_find": {"status_code": 200, "data": {...} }, 
 "dropbox_files": {"status_code": 200, "data": {...} }
 }
В случае неудачного запроса для одного из сервисов, возвращается код состояния и саму ошибку

---

### URI: http://127.0.0.1:5000/api/auth

#### GET Запрос
Возвращает ссылку для получения кода авторизации

#### POST Запрос
Отправка полученного кода авторизации на сервер с последующим получением новых токенов

##### Параметры
Передаются в теле запроса в формате json: 
`{    
    "auth_type": "authorization_code", 
	"token_code": <код или действительный рефреш токен>
}`
- "auth_type" - может иметь значения "authorization_code" (по умолчанию) или "refresh_token"

#### DELETE Запрос
Отзыв токенов и удаление их из базы
В случае неудачного запроса, возвращается код состояния и саму ошибку
